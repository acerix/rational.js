<!DOCTYPE html>
<html lang="en-ca">
<head>
<meta charset="utf-8">
<title>rational.js tester</title>
<script src="http://acerix.github.com/rational.js/releases/rationaljs.alpha.js"></script>
<script src="../src/integer.js"></script>
<script src="../src/biginteger.js"></script>
<script src="../src/bigint.js"></script>
<script src="../src/rat.js"></script>
<script src="../src/bigrat.js"></script>
<script src="../src/rational.js"></script>
<script src="../src/alpha.js"></script>
<script src="../src/polyrat.js"></script>
<script src="../src/physics.js"></script>
<script>

var input, output;

window.onload = function() {
	input = document.getElementById('input');
	input.focus();
	output = document.getElementById('output');
	go();
}

function go() {
	eval('{'+input.value+'}');
}

function clr() {
	output.innerHTML = '';
}

function print(s) {
	if (typeof s !== 'undefined') output.innerHTML += s.toString();
	output.innerHTML += '\n';
}

var alt_down = false, shift_down = false, ctrl_down = false;

function insertTextAtCursor(text) {
	var sel, range, html;
	if (window.getSelection) {
		sel = window.getSelection();
		if (sel.getRangeAt && sel.rangeCount) {
			range = sel.getRangeAt(0);
			range.deleteContents();
			range.insertNode( document.createTextNode(text) );
		}
	}
	else if (document.selection && document.selection.createRange) {
		document.selection.createRange().text = text;
	}
}

window.onkeydown = function(e) {
	if (!e) e=event;
	var k = e.which;
    switch (k) {
		case 9: // tab
			e.preventDefault();
			insertTextAtCursor('\t');
			break;
		case 13: // enter                   
			if (alt_down) clr();
			if (alt_down||ctrl_down) go();
			break;
		case 16: // shift
			shift_down = true;
			break;
		case 17: // ctrl
			ctrl_down = true;
			break;
		case 18: // alt
			alt_down = true;
			break;
//		default: print('key down: '+k);
	}
}

window.onkeyup = function(e) {
	//clr(); go();
	var k = (e?e:event).which;
    switch (k) {
		case 16: // shift
			shift_down = false;
			break;
		case 17: // ctrl
			ctrl_down = false;
			break;
		case 18: // alt
			alt_down = false;
			break;
	}
}

function dumpStack() {
	try {fake+=0;}
	catch(e) {console.log(e.stack);}
}


</script>
</head>
<body>

<textarea id="input" style="width:99%;padding:3px 10px;" rows="24">
clr(); print('');


var precision = 4;

var x = bigrat.fromInteger(0);
var r = bigrat.fromInteger(0);
var t = bigrat.fromInteger(2);

for (var n=0; n<=precision; n++) {
  print('n['+n+']');
  bigrat.add(r, x, t);
  bigrat.sqrt(x, r);
  print(bigrat.dump(x));
  print();
}

print();
print('pi() :');

// 2^(2n+1)
var a1 = 2 << (2 * precision);

// 2^(2n)
var a2 = a1 >> 1;

var pi = bigrat.fromInteger( a1 );
var p2 = bigrat.fromInteger( a2 );

bigrat.mul(x, x, p2);
bigrat.sub(pi, pi, x);

print(bigrat.dump(pi));

bigrat.sqrt(x, pi);
bigrat.scalar_multiply(x, x, 4);

print(bigrat.dump(x));

/*
  print();
print('pi :');

print(bigrat.dump(bigrat.PI));
*/
  print();
  print();	
print('pi^2 / 16 :');

var p16 = bigrat.fromRat(bigrat.create(), rat.PI);
bigrat.pow(p16, p16, 2);
bigrat.scalar_divide(p16, p16, 16);

print(bigrat.dump(p16));

/*
var PN_Fermat = [
  [-1, 0, 0, 1],
  [0],
  [0],
  [1]
]

var fermat = polyrat.fromValues(PN_Fermat);



print(polyrat.str(fermat));
print('');
print(polyrat.getJSFormula(fermat));

print('');
print('');
print('');

var x2 = polyrat.fromValues([0, 0, 1]);

print(polyrat.str(x2));

print('= '+bigrat.str(polyrat.evaluate(bigrat.create(), x2, [6])));

//print(polyrat.forEachNonZeroElement(x2, print));

//print(rat.str(polyrat.evaluate(x2, [2])));


print('');
print('');
print('');

var x2_y2 = polyrat.fromValues([
	[0, 0, 1],
	[0, 0, 0],
	[1, 0, 0]
]);

print(polyrat.str(x2_y2));
print('');
print(polyrat.getJSFormula(x2_y2));

print('= '+bigrat.str(polyrat.evaluate(bigrat.create(), x2_y2, [6, 9])));



print('');
print('');
print('');

var x4_y4_z4 = polyrat.fromValues([
[
	[0, 0, 0, 0, 1],
	[0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0],
	[1, 0, 0, 0, 0]
],
[
	[0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0]
],
[
	[0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0]
],
[
	[0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0]
],
[
	[1, 0, 0, 0, 0],
	[0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0]
]
]);

print(polyrat.str(x4_y4_z4));
print('');
print(polyrat.getJSFormula(x4_y4_z4));

//print(polyrat.forEachNonZeroElement(x4_y4_z4, print));

print('= '+bigrat.str(polyrat.evaluate(bigrat.create(), x4_y4_z4, [5,9,3])));

print('');
print('');

var crazy_polynomial = polyrat.fromValues([
[
	[7, 6, 3, 0, 1],
	[0, 0, 4, 0, 0],
	[0, 0, 1, 0, 0],
	[0, 0, 0, 0, 0],
	[1, 0, 0, 0, 0]
],
[
	[0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0],
	[0, 0, 0, 6, 0],
	[0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0]
],
[
	[0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0],
	[0, 5, 0, 0, 0],
	[0, 0, 0, 0, 0],
	[0, 0, 4, 0, 0]
],
[
	[0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0]
],
[
	[1, 0, 0, 0, 0],
	[0, 0, 0, 0, 0],
	[0, 0, 0, 0, 0],
	[0, 0, 4, 0, 0],
	[1, 0, 0, 5, 99]
]
]);

crazy_polynomial[1][2] = 24;
crazy_polynomial[1][1] = -9;

print(polyrat.str(crazy_polynomial));

print('');
print(polyrat.getJSFormula(crazy_polynomial));
print('= '+bigrat.str(polyrat.evaluate(bigrat.create(), crazy_polynomial, [5,9,3])));

*/

/*

print(new rational(420, 69).times(new rational(123, 456)).pow(4).divide(new rational(2446, 445)).divide(new rational(22, 33)).dump());

print(bigrat.dump(bigrat.fromContinuedFraction(bigrat.create(),
	[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
)));

print(bigrat.dump(bigrat.fromContinuedFraction(bigrat.create(),
	[2,1,2,1,1,4,1,1,6,1,1,8,1,1,1,10,1,1,1,12,1,1,1,14,1,1,1,16,1,1,1,18,1,1,1,20,1,1,1,22,1,1,1,24]
)));

print(rational.fromDecimal(0.697774657964008).dump());

var nth = 2;
var root = bigrat.fromInteger(2);

for (var n=1; n<30; n++) {
  print('nthRoot('+n+', '+nth+')');
  bigrat.nthRoot(root, bigrat.fromInteger(n), nth);
  print(bigrat.dump(root));
}

var PHI = ( 1 + Math.sqrt(5) ) / 2;
print(bigrat.dump(bigrat.fromDecimal(PHI)));
print(bigrat.dump(bigrat.fromDecimal(PHI - 1)));

bigrat.PHI = bigrat.fromInteger(5);
bigrat.sqrt(bigrat.PHI, bigrat.clone(bigrat.PHI));
bigrat.add(bigrat.PHI, bigrat.clone(bigrat.PHI), bigrat.ONE);
bigrat.scalar_divide(bigrat.PHI, bigrat.clone(bigrat.PHI), 2);
print(bigrat.dump(bigrat.PHI));

print(bigrat.dump(bigrat.fromDecimal(Math.PI)));
print(rat.dump(rat.PI));
print(bigrat.dump(bigrat.PI));

print(bigrat.dump(physics.A));
print(bigrat.dump(bigrat.invert(bigrat.create(), physics.A)));

print(bigrat.dump(physics.H));
print(bigrat.dump(physics.HBAR));

print(bigrat.dump(bigrat.fromDecimal(Math.E)));

print(bigrat.dump(bigrat.fromDecimal(Math.LN2)));
print(bigrat.dump(bigrat.fromDecimal(Math.LOG2E)));
print(bigrat.dump(bigrat.fromDecimal(Math.LN10)));
print(bigrat.dump(bigrat.fromDecimal(Math.LOG10E)));

*/

</textarea>

<br />

<input type="button" value="go" onclick="clr();go();" style="width:98%;margin:10px;float:right;">

<pre id="output" style="width:99%;border:1px black outset;clear:both;padding:10px;"></pre>

</body>
</html>
